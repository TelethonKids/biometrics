---
title: "Telethon Kids Institute"
subtitle: "Biometrics Markdown HTML Template"
author:
  - "Author&nbsp;1<sup>1</sup> and Author&nbsp;2<sup>2</sup>"
affiliation:
  - "<sup>1</sup>Telethon Kids Institute, Biometrics Group"
  - "<sup>2</sup>Other Affiliation(s)"
date: "`r format(Sys.time(), '%d %B %Y')`"
logo: assets/images/logo800.jpg
nav_logo: assets/images/logo_plain.jpg
header-background: green-circles-darker
header-breakout: pms2395-breakout
output:
  html_document:
    toc: true
    toc_float: true
    template: assets/templates/html_report.html
    css: assets/css/html_report.css
    self_contained: true
vignette: >
  %\VignetteIndexEntry{Biometrics Markdown HTML Template}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
bibliography:
  - assets/bib/packages.bib
  - assets/bib/bibliography.bib

---

```{r init, include = FALSE}
# Load packages and add citation information to packages.bib
# By default, packages listed in global.dcf are ignored and environment initiation is handled by .RProfile.
library(repmis)
LoadandCite(pkgs = c("tidyverse", "lubridate", "ProjectTemplate", "repmis", "biometrics", "knitr", "kableExtra", "broom", "GGally", "lme4"),
            file = "assets/bib/packages.bib")

# loads in template hooks
source("assets/R/hooks.R")

```

# Summary

This is a markdown template to produce HTML files. The template is a part of the biometrics package developed by Paul&nbsp;Stevenson at Telethon Kids Institute. The template is built on bootstrap and the associated formatting tags *should* be available.

# Introduction

## Markdown Cheat Sheet

The [markdown RStudio cheat sheat is here](https://www.rstudio.com/resources/cheatsheets/). Various information can be found here, including **shortcuts** to *modify the text*. [Bootstrap typography codes](https://www.w3schools.com/bootstrap4/bootstrap_typography.asp) also seem to be available to format markdown HTML documents; this feature has not been thoroughly tested by the author.

## Referencing

Referencing important previous work and the scientific principles that underpin research is a vital aspect of any report. The default bibliography list that is used by this template is found in <code>assets/bib/bibliography.bib</code>. The author has included these references in the document for illustrative purposes [-@STEVENSON2017119]; however, they have nothing to do with anything that is written here [@CiteR; @R-lubridate].

Bibliographic information for R packages are automatically generated (and loaded) with LoadandCite [@R-repmis]. By default, the package bibliography is stored in <code>assets/bib/packages.bib</code>, which is overwritten on each Knit and should not be manually altered.

References are automatically placed at the end of the document, so it is important that a header, such as <code>#&nbsp;References</code>, is placed at the end of your markdown document.

## Adding R Script to Markdown
R chunks are added through the following blocks of code:

<code>
\`\`\`{r chunk_name, include = FALSE}<br />
&nbsp;&nbsp;print("Hello World!")<br />
\`\`\`
</code><br />

The above code produces the following in the markdown document:
```{r hello_world, include = TRUE}
  print("Hello World!")

```

The <code>echo = FALSE</code> argument can be used if you do not want the source code to be displayed:
```{r echo_false, echo = FALSE}
  print("In this example, the source code has been hidden and only the output is displayed.")

```

Output can be suppressed entirely by changing <code>include = FALSE</code>, or by removing the argument.

# Methods

This template is built with the ProjectTemplate package in mind. By default, all data in the "cache" directories will be loaded. Files in the data directory are note loaded by default, but can be by setting <code>data_loading = TRUE</code> in the initialisation markdown chunk. Similarly, by default <code>munge = FALSE</code> and scripts in the munge directory will not be executed.

R's included Iris data set will be used to illustrate how to include graphics and to use the colour palettes defined at the start of the document:

```{r load_data}
data(iris)

```

# Results

## Example Tables

### Basic data

Kable is a very simple table generator that takes input as either a matrix or data frame [@R-kableExtra]; see the [Kable documentation](https://www.rdocumentation.org/packages/kableExtra/versions/0.8.0/topics/kable_styling) for styling options available.

In this template the kable formatting is applied automatically when using the chunk option <code>chunk option "table = T"</code>. By default, this template uses the <code>hover</code> style with <code>full_width = FALSE</code>. (Technical info: automatic formatting is implemented by <code>kintr::knit_hooks()</code> [@R-knitr] *via* the chunk **source** and optimal results are achieved when including the option <code>results = "hide"</code>. For the same reason, <code>eval = F</code> is included so that the chunk is not evaluated twice. The source code cannot be shown when the kable formatting is automatically applied.)

For example:

<code>
\`\`\`{r, table = T, results = "hide", eval = F}<br />
&nbsp;&nbsp;head(iris)<br />
\`\`\`<br />
</code>

will output:

```{r automatic_table, table = T, results = "hide", eval = F}
head(iris)

```

If custom table options are needed, then the kable formatting can be applied as normal:
```{r manual_table}
head(iris) %>%
  kable("html") %>%
  kable_styling("hover", full_width = TRUE)

```

### Model output
The <code>broom::tidy</code> [@R-broom] function may be used to convert the output into a data frame that is compatible with kable When data is supplied from a model, which may be more appropraite for a report or publication.

For example, the summary output of a linear mixed effects model (<code>lmr4::lmer</code>) looks like:

```{r model_summary, comment = ""}
model <- lmer(Sepal.Length ~ Sepal.Width + Petal.Width + (1|Species), data = iris)

summary(model)

```

Broom defines tidying methods for extracting three kinds of statistics from an object ([see here](https://opr.princeton.edu/workshops/Downloads/2016Jan_BroomRobinson.pdf)):

* tidy(): component-level statistics
* augment(): observation-level statistics
* glance(): model-level statistics

**tidy():**

```{r tidy, table = T, results = "hide", warning = F}
tidy(model)

```

**glance():**

```{r glance, table = T, results = "hide"}
glance(model)

```

**augment():**

```{r augment, table = T, results = "hide"}
augment(model) %>%
  head()

```

## Example Plots

The <code>GGally::ggpairs</code> function may be used to produce a visual summary of the input data:

```{r ggpairs, out.extra = 'class="img-fluid center"', message = FALSE}
ggpairs(iris, mapping=ggplot2::aes(colour = Species), diag = list(continuous = "densityDiag"),
        axisLabels = "show")

```

<!--<mark>TO DO: Apply Telethon Kids' colour scheme to ggpairs plot.</mark>-->

### Colour schemes

There are three colour schemes built into this theme: <code>scale_colour_telethonkids("light")</code>, <code>scale_colour_telethonkids("dark")</code> and <code>scale_colour_telethonkids("grey")</code>. These colour themes are implemented by adding the appropriate theme to the ggplot code:

```{r discrete_plot, out.extra = "figure"}
ggplot(iris, aes(Petal.Width, Petal.Length, color = Species)) +
  labs(title = "Iris Dataset", x = "Petal Width", y = "Petal Length") +
  geom_point(size = 4) +
  scale_color_telethonkids("light") +
  theme_classic()

```

A continuous colour theme can be implemented by adding the argument <code>discrete = FALSE</code> the <code>scale_colour_telethonkids()</code>:

```{r continuous_plot, out.extra = "figure"}
ggplot(iris, aes(Petal.Width, Petal.Length, color = Petal.Length)) +
  geom_point(size = 4, alpha = .6) +
  scale_color_telethonkids(discrete = FALSE, palette = "dark") +
  theme_classic()

```

Bar plots can also be 'filled' by discrete variables with differnt palettes by using <code>scale_fill_telethonkids(palette = "mixed", guide = "none")</code>.

To ensure the image is responsive on different sized screens, the code <code>out.extra = "figure"</code> should be included in the R chunk options (this calls an option hook defined in <code>hooks.R</code>).

# References

